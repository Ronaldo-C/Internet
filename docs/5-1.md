
## Linux命令 

原创作者：于立

### 写在前面的话

关于技术知识或经验的整理，有时候受限于个人的见识或能力，往往有不尽如人意的地方。好在这里的重点并非一味地体现技术，而是希望回顾过去进而达到创新的目的。

不足之处，欢迎有识之士斧正。同时欢迎投稿 [GitHub](https://github.com/shxingzhe/Internet) ，请提交 issue 。

### 正文

Linux 系统中图形化工具其实是调用了脚本来完成相应的工作，往往只是为了完成某种工作而设计的，缺乏 Linux 命令原有的灵活性及可控性。再者，图形化工具相较于 Linux 命令行界面会更加消耗系统资源，因此直接使用命令行模式是很高效的。

Linux 系统中最常使用的 Shell 终端是 Bash 解释器， Shell 充当的是人与内核（硬件）之间的翻译官，用户把一些命令“告诉”终端，它就会调用相应的程序服务去完成某些工作。选择 Bash 解释器作为命令行终端主要有以下4项优势：

> 1、通过上下方向键来调取过往执行过的 Linux 命令；

> 2、命令或参数仅需输入前几位就可以用 Tab 键补全；

> 3、具有强大的批处理脚本；

> 4、具有实用的环境变量功能。


#### 命令格式

Linux 命令的常见格式：

    命令名称 [命令参数] [命令对象]

注意：命令名称、命令参数、命令对象之间请用空格键分隔。

命令参数是为了让 Linux 命令能够更贴合用户的实际需求进行工作，命令对象一般是指要处理的文件、目录、用户等资源。

命令参数可以用长格式（完整的选项名称），也可以用短格式（单个字母的缩写），两者分别用--与-（减号）作为前缀。长格式所必须的参数在使用短格式时也是必须的。

格式|示例
---|---
长格式|man --help
短格式|man -h

长格式和长格式之间不能合并，长格式和短格式之间也不能合并，但短格式和短格式之间是可以合并的，合并后仅保留一个-即可。另外， ps 命令可允许参数不加-，因此可直接写成 ps aux 。

命令参数比较复杂，参数值会随不同的命令和需求情况而发生改变。对于很多命令，只需掌握常用的参数并做到灵活搭配即可，这就足以应对日常的工作了。


#### 重定向、管道符与环境变量等<sup>1</sup>

##### 1. 输入输出重定向

输入重定向是指把文件导入到命令中，而输出重定向则是指把原本要输出到屏幕的数据信息写入到指定文件中。

相较于输入重定向，我们使用输出重定向的频率更高，所以又将输出重定向分为了标准输出重定向和错误输出重定向两种技术，以及清空写入与追加写入两种模式。

> 标准输入重定向（STDIN，文件描述符为0，使用<或<<）：默认从键盘输入，也可从其他文件或命令中输入。

> 标准输出重定向（STDOUT，文件描述符为1，使用>或>>）：默认输出到屏幕。

> 错误输出重定向（STDERR，文件描述符为2，使用2>或2>>）：默认输出到屏幕。

输入重定向中用到的符号及其作用：

符号|作用
---|---
命令 < 文件 或 命令 <0 文件|将文件作为命令的标准输入
命令 << 分界符 或 命令 <<0 文件|从标准输入中读入，直到遇见分界符才停止
命令 < 文件1 > 文件2|将文件1作为命令的标准输入并将标准输出到文件2

输出重定向中用到的符号及其作用：

符号|作用
---|---
命令 > 文件 或 命令 1> 文件|将标准输出重定向到一个文件中（清空原有文件的数据）
命令 2> 文件|将错误输出重定向到一个文件中（清空原有文件的数据）
命令 >> 文件 或 命令 1>>文件|将标准输出重定向到一个文件中（追加到原有内容的后面）
命令 2>> 文件|将错误输出重定向到一个文件中（追加到原有内容的后面）
命令 >> 文件 2>&1 或 命令 &>> 文件|将标准输出与错误输出共同写入到文件中（追加到原有内容的后面）

```
#将man bash命令原本要输出到屏幕的信息写入到文件readme.txt中
man bash > readme.txt

#首先通过覆盖写入模式向readme.txt文件写入一行数据，然后再通过追加写入模式向文件再写入一次数据
echo "hello yuli" > readme.txt
echo "hello yuli" >> readme.txt

#使用标准输出即可将原本要输出到屏幕的信息写入到文件中，而错误的输出重定向则依然把信息输出到了屏幕上
[root@ ~]# ls -l dir > /root/stderr.txt
[root@ ~]# ls -l dir 2> /root/stderr.txt

#把readme.txt文件导入给wc -l命令，统计一下文件中的内容行数
wc -l < readme.txt
```

##### 2. 管道命令符

管道命令符的作用：把左面（前面）命令的输出值作为右面（后面）命令的输入值以便进一步处理信息。

> 格式：命令A | 命令B | 命令C | ……

```
#用翻页的形式查看/etc目录中的文件列表及属性信息
ls -l /etc/ | more

#使用mail邮件命令与输入重定向的分界符，让用户一直输入内容，直到用户输入了其自定义的分界符时，才结束输入。
[root@ ~]# mail -s "Hello" 1394172397qq.com << over
> Can you star me?
> over
```

典型的命令序列：

命令序列|说明
:--|:--
command & | command 在子 shell 的 background 运行。<br/>管理这些后台任务的请求需要 shell 内建的: jobs, fg, bg 和 kill。
command1 &#124; command2 | command1 的标准输出被直接输入到 command2 的标准输入。<br/>两个命令都可能并行地运行。这个被称作 pipeline 。
command1 ; command2 | command1 、 command2 被有序地执行。
command1 && command2 | command1 如果执行成功的话那么再执行 command2。<br/>只有当 command1 并且 command2 都运行成功的话，上面的命令序列才会成返回。
command1 &#124;&#124; command2 | command1 被执行以后，如果不成功的话， command2 也会被执行。<br/>其中有一个执行成功的话，上面的序列就会返回真值。
command > foo | 把 command 的标准输出重定向到文件 foo。(覆盖内容)
command >> foo | 把 command 的标准输出重定向到文件 foo。(追加)
command > foo 2>&1 | 同时把 command 的标准输出和标准出错信息重定向到文件foo。
command < foo | 把 command 的标准输入重定向到一个文件 foo。

如果我们在系统终端中执行一个命令后想立即停止它，可以同时按下 Ctrl + C 组合键。或者，如果有些命令在执行时不断地在屏幕上输出信息，影响到后续命令的输入，则可以在执行命令时在末尾添加上一个&符号，这样命令将进入系统后台来执行。

##### 3. 命令行的通配符

通配符就是通用的匹配信息的符号，比如星号（\*）代表匹配零个或多个字符，问号（?）代表匹配单个字符，中括号内加上数字[0-9]代表匹配0～9之间的单个数字的字符，而中括号内加上字母 [abc] 则是代表匹配 a、b、c 三个字符中的任意一个字符。

```
#匹配所有在/dev目录中且以sda开头的文件
ls -l /dev/sda*

#查看文件名为sda开头，后面还紧跟其他某一个字符的文件的相关信息
ls -l /dev/sda?
```

##### 4. 常用的转义字符

4个最常用的转义字符如下：

> 反斜杠（\） ：使反斜杠后面的一个变量变为单纯的字符串。

> 单引号（''）：转义其中所有的变量为单纯的字符串。

> 双引号（""）：保留其中的变量属性，不进行转义处理。

> 反引号（\`\`）：把其中的命令执行后返回结果。

```
[root@ ~]# PRICE=5
[root@ ~]# echo "Price is $PRICE"
Price is 5
[root@ ~]# echo "Price is $$PRICE" 
Price is 3767PRICE
[root@ ~]# echo "Price is \$$PRICE"
Price is $5
[root@ ~]# echo `uname -a`
Darwin bogon 17.4.0 Darwin Kernel Version 17.4.0: ……
```

##### 5. 重要的环境变量

Linux 系统中的环境变量是用来定义系统运行环境的一些参数，比如每个用户不同的家目录、邮件存放位置等。变量名称一般都是大写的，这是一种约定俗成的规范。

```
[root@ ~]# echo $PATH
/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin
[root@ ~]# PATH=$PATH:/root/bin
```

尽管可以将当前目录（.）添加到 PATH 变量中，可以让用户免去输入命令所在路径的麻烦。但是，如果黑客在公共目录 /tmp 中存放了与 ls 或 cd 命令同名的木马文件，而用户可能在公共目录中执行这些命令导致中招，因此不能将当前目录（.）添加到 PATH 中。

Linux作为一个多用户多任务的操作系统，能够为每个用户提供独立的、合适的工作运行环境，因此，一个相同的变量会因为用户身份的不同而具有不同的值。


### 参考资料

[1] 刘遄. Linux就该这么学. 2017.


### 附：常用词汇

词汇|释义
:---:|---
Shell|[ʃɛl] ，终端，壳，外壳
CLI|command-line interface ，命令行界面
GUI|[ˈɡu:i] , graphical user interface ，图形用户界面 
firmware|固件
authorization|[ˌɔːθərəˈzeɪʃn] ，授权
client-server|客户端-服务器
runtime|[rʌnˈtaɪm] ，运行时间，运行期
permanent|[ˈpɜːrmənənt] ，永久的
communication|[kəˌmjunɪˈkeʃən] ，通信
community|社区


### 附：拓展资源

[Linux命令大全(手册)](http://man.linuxde.net)


### 订阅

微信搜索“于立为文”（**及时、最早、最全更新，同时保证最新活动入口，极力推荐**），或者扫描二维码

![](./wechat-mp.jpg)


以下平台会同步更新：

[· GitHub](https://github.com/shxingzhe/Internet)

[· 语雀](https://www.yuque.com/yuli/internet)
